# SAM3 标注工具 - 快速开始指南

## 5 分钟快速上手 ⚡

### 第一步：安装依赖 (1 分钟)

```bash
# Windows 用户
start_annotator.bat

# 或者手动安装
pip install PyQt5 scikit-image
```

### 第二步：启动工具 (10 秒)

```bash
python sam3_annotator.py
```

### 第三步：加载模型 (30 秒)

1. 点击 **"浏览模型"**
2. 选择 `experiments/checkpoints/model_fp16.pt`
3. 点击 **"加载模型"**
4. 等待显示 "模型: 已加载" ✅

### 第四步：加载图像文件夹 (10 秒)

1. 点击 **"加载文件夹"**
2. 选择包含图像的文件夹
3. 看到提示："已加载 XX 张图像"

### 第五步：开始标注！ (3 分钟)

#### 方法 A：文本提示（最快）

1. 在 **"文本提示"** 输入框输入：`car`
2. 在 **"当前标签"** 输入框输入：`car`
3. 点击 **"运行文本提示"**
4. 🎉 所有车辆自动标注完成！

#### 方法 B：点提示（最精确）

1. 选择 **"点提示"** 模式
2. **左键** 点击目标内部
3. **右键** 点击不要的区域
4. 点击 **"运行点提示"**
5. 🎉 精确分割完成！

#### 方法 C：框提示（最简单）

1. 选择 **"框提示"** 模式
2. 在图像上拖拽绘制边界框
3. 🎉 自动分割完成！

### 第六步：切换图片 (1 秒/张)

按 **D 键** → 下一张（自动保存当前标注）
按 **A 键** → 上一张

就这么简单！继续标注所有图片。

---

## 常用快捷键 ⌨️

| 快捷键 | 功能 | 使用场景 |
|--------|------|----------|
| **A** | 上一张图片 | 导航 |
| **D** | 下一张图片 | 导航 |
| **滚轮** | 缩放图像 | 查看细节 |
| **+** | 放大 | 放大视图 |
| **-** | 缩小 | 缩小视图 |
| **0** | 重置缩放 | 恢复原始大小 |
| **Ctrl+S** | 保存 | 手动保存 |

---

## 三种标注模式对比

### 🚀 文本提示 - 批量标注
- **速度**: ⭐⭐⭐⭐⭐ 最快
- **精度**: ⭐⭐⭐⭐ 高
- **适用**: 批量检测同类目标
- **示例**: 检测图中所有"car"、"person"

### 🎯 点提示 - 精确标注
- **速度**: ⭐⭐⭐ 中等
- **精度**: ⭐⭐⭐⭐⭐ 最高
- **适用**: 精确标注单个复杂目标
- **示例**: 标注被遮挡或边界复杂的物体

### 📦 框提示 - 快速标注
- **速度**: ⭐⭐⭐⭐ 快
- **精度**: ⭐⭐⭐⭐ 高
- **适用**: 快速标注规则形状
- **示例**: 标注车辆、建筑物等

---

## 实战案例

### 案例 1：标注 100 张街景图中的车辆

```
时间: 约 15 分钟

步骤:
1. 加载文件夹（100 张图片）
2. 文本提示输入 "car"
3. 点击"运行文本提示"
4. 按 D 键，重复步骤 3
5. 完成！

效率: 每张图约 9 秒
```

### 案例 2：精确标注医学图像中的病灶

```
时间: 约 30 秒/张

步骤:
1. 选择点提示模式
2. 左键点击病灶中心
3. 左键点击病灶边缘几个点
4. 右键点击正常组织
5. 运行点提示
6. 按 D 键到下一张

精度: 非常高
```

### 案例 3：快速标注产品图片

```
时间: 约 5 秒/张

步骤:
1. 选择框提示模式
2. 拖拽鼠标框选产品
3. 自动生成精确 mask
4. 按 D 键到下一张

效率: 最高
```

---

## 标注技巧 💡

### 提高速度
1. ✅ 使用文本提示批量检测
2. ✅ 使用 A/D 键快速切换
3. ✅ 利用自动保存，无需手动保存
4. ✅ 调整置信度阈值减少误检

### 提高精度
1. ✅ 放大图像查看细节（滚轮）
2. ✅ 点提示时多添加几个点
3. ✅ 在边界处添加前景点
4. ✅ 在干扰物处添加背景点

### 混合使用
1. 文本提示快速标注大部分目标
2. 点提示精确标注困难目标
3. 框提示补充遗漏目标

---

## 输出格式

生成的 JSON 文件格式：

```
dataset/
├── image001.jpg
├── image001.json  ← labelme 格式
├── image002.jpg
├── image002.json
└── ...
```

**JSON 文件特点：**
- ✅ 完全兼容 labelme
- ✅ 文件小（不含图像数据）
- ✅ 可用 labelme 打开编辑
- ✅ 支持多边形和矩形

---

## 故障排除 🔧

### Q: 模型加载失败
```bash
# 检查文件是否存在
ls experiments/checkpoints/model_fp16.pt

# 检查文件大小（应该约 170MB）
```

### Q: 快捷键不工作
- 确保标注工具窗口处于焦点状态
- 点击一下画布区域再按快捷键

### Q: 自动保存没有生效
- 只在加载文件夹模式下才有自动保存
- 切换图片时才会触发自动保存

### Q: 标注结果不准确
- 调整置信度阈值（0.3-0.5）
- 使用点提示模式手动标注
- 放大图像查看细节

---

## 下一步

### 进阶功能
- 📖 阅读 [README_ANNOTATOR.md](README_ANNOTATOR.md) 了解详细功能
- 📖 阅读 [ANNOTATION_GUIDE.md](ANNOTATION_GUIDE.md) 学习高级技巧

### 批量自动标注
- 使用 `batch_annotate.py` 脚本批量处理大量图像
- 查看帮助: `python batch_annotate.py --help`

### 与训练集成
- 标注完成后可直接用于训练
- 支持转换为 COCO、YOLO 等格式

---

## 获得帮助

- 💬 状态栏显示实时提示
- 📖 查看完整文档
- 🐛 遇到问题？检查终端输出的错误信息

---

**🎉 开始标注吧！祝你标注愉快！**

```bash
python sam3_annotator.py
```

